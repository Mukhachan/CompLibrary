{% extends 'base.html' %}
{% block content %}
{{ super() }}

<style>
    .textarea{
        height: 390px;
        width: 100%;

        background-color:rgb(255, 255, 255);
        resize: none;
    }
    title{
        margin: auto;
    }
    .button-save{
        float: right;  
        margin: auto;
        width: 8em;
        
        
        padding: 3px;
        cursor: pointer;
        border-radius: 5px;
        border: 1px solid rgb(97, 97, 97);
        margin-right: 5px;
        text-align: center;
    }
    .upload{
    display: none;
    overflow: hidden;
    }
    .button-edit {
        background-color: white;
        margin: auto;
        width: 10em;
        display: inline-block;
        padding: 3px;
        cursor: pointer;
        
        border-radius: 5px;
        border: 1px solid #ccc;
        margin-left: 20%; 
        text-align: center;
    }
    .button-edit:hover , .button-save:hover {
        background: #ddd;
    }
    .image{
        padding: 0%;        
    }
    .number, .year{
        width: 100%;
    }
    .numbers{
        width: 80px;
    }
    .flash_cat{
        margin: auto; 
        margin-top: 10px; 
        margin-bottom: 10px;
        text-align: center; 
        width: 50%;
        font-size: 14pt; 
        background: rgb(81, 255, 0); 
        border-radius:10px
    }
</style>

<script>
function myFunction(){
  var x = document.getElementById("fileElem");
  var txt = "";
  if ('files' in x) {
    if (x.files.length == 0) {
      txt = "Select one or more files.";
    } else {
      for (var i = 0; i < x.files.length; i++) {
        var file = x.files[i];
        if ('name' in file) {
          txt += file.name;
        }
      }
    }
  } 
  else {
    if (x.value == "") {
      txt += "Select one or more files.";
    } else {
      txt += "The files property is not supported by your browser!";
      txt  += "<br>The path of the selected file: " + x.value; // If the browser does not support the files property, it will return the path of the selected file instead. 
    }
  }
  document.getElementById("demo").innerHTML = txt;
  document.getElementById("inp").value = txt;
}

</script>

{% for cat, msg in get_flashed_messages(True) %}
{% if cat == 'success' %}
<div class="flash_cat" style="background-color: rgb(11, 204, 11);">{{msg}}</div>
{% elif cat == 'error' %}
<div class="flash_cat" style="background-color: red;">{{msg}}</div>

{% endif %}
{% endfor %}

<div class="form">
<form action="/book_card?edit={{id}}" method="post" enctype="multipart/form-data">
        <div class="title" style="margin-bottom: 8px;">
            <input type="text" style='width: 30%;' name='btitle' value="{{titlet}}">
            <input type="text" style='width: 30%;' name='author' value="{{author}}">            
        </div>

    {% for row in results %}
    {% if id %}
    <table border="1px" style="margin: auto;">
    <tr>
        <td>
            <img class='image' src="/static/pictures/{{row['book_picture']}}" alt="{{row['picture_name']}}" height='390px'>
        </td>
        <div class="psevdo_div">
            <td style="width: 55%;">
                <textarea class="textarea" name="descript" >{{row['descript']}}</textarea>
            </td>
        </div>
        <td>
        <table style="margin: auto;">
            <tr>
                <td class="numbers"><input class='number' type="number" name="number" value="{{row['number']}}"></td>
            </tr>
            <tr>
                <td class="numbers"><input class='year' type="number" name="year" value="{{row['year']}}"></td>
            </tr>
        </table>
        </td>
    </tr>
    <tr>
        <td>                
            <div id="drop-area">
                <input class="upload" type="file" name="book_picture" id="fileElem" 
                            accept="image/*" onchange="myFunction()">
                <label class="button-edit" for="fileElem" >Изменить картинку</label>
                <p id="demo" ></p>
                <input type="text" name="book_picture" style="display: none;" id="inp">
            </div>
        </td>
        <td>
            <button class="button-save" value='{{row["id"]}}' type="submit">Сохранить</button>
        </td>
    </tr>
    </table>

    {% else %}
    {{id}}
    <div>Ничего</div>

    {% endif %}
    {% endfor %}

</form>
</div>

{% endblock %}
